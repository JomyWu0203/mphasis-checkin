<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub éƒ¨ç½²æª¢æŸ¥å™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            padding: 20px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 10px;
        }

        .header h1 {
            color: #2c3e50;
            font-size: 1.6rem;
            margin-bottom: 10px;
        }

        .status-box {
            padding: 16px;
            border-radius: 12px;
            margin: 16px 0;
            font-weight: 500;
        }

        .status-success {
            background: rgba(76, 175, 80, 0.1);
            border: 2px solid #4CAF50;
            color: #2e7d32;
        }

        .status-error {
            background: rgba(244, 67, 54, 0.1);
            border: 2px solid #f44336;
            color: #c62828;
        }

        .status-warning {
            background: rgba(255, 193, 7, 0.1);
            border: 2px solid #ffc107;
            color: #f57f17;
        }

        .status-checking {
            background: rgba(33, 150, 243, 0.1);
            border: 2px solid #2196F3;
            color: #1976D2;
        }

        .button {
            width: 100%;
            padding: 14px;
            font-size: 1rem;
            font-weight: 600;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 12px;
        }

        .button-primary {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
        }

        .button-secondary {
            background: linear-gradient(45deg, #2196F3, #1976D2);
            color: white;
        }

        .button-warning {
            background: linear-gradient(45deg, #ff9800, #f57c00);
            color: white;
        }

        .button:active {
            transform: scale(0.98);
        }

        .url-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            margin-bottom: 12px;
            font-size: 0.9rem;
        }

        .url-input:focus {
            outline: none;
            border-color: #4CAF50;
        }

        .file-check {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            margin: 8px 0;
            border-radius: 8px;
            background: #f8f9fa;
        }

        .file-name {
            font-family: monospace;
            font-size: 0.9rem;
        }

        .file-status {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .file-exists {
            background: #d4edda;
            color: #155724;
        }

        .file-missing {
            background: #f8d7da;
            color: #721c24;
        }

        .file-checking {
            background: #d1ecf1;
            color: #0c5460;
        }

        .step {
            display: flex;
            align-items: flex-start;
            margin-bottom: 16px;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .step-number {
            background: #4CAF50;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 12px;
            flex-shrink: 0;
            font-size: 0.9rem;
        }

        .step-content {
            flex: 1;
        }

        .step-title {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 4px;
        }

        .step-description {
            color: #555;
            font-size: 0.9rem;
            line-height: 1.3;
        }

        .code-box {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 12px;
            font-family: monospace;
            font-size: 0.85rem;
            margin: 10px 0;
            word-break: break-all;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin: 12px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #4CAF50, #45a049);
            width: 0%;
            transition: width 0.3s ease;
        }

        .quick-fix {
            background: rgba(33, 150, 243, 0.1);
            border: 2px solid #2196F3;
            border-radius: 12px;
            padding: 16px;
            margin: 16px 0;
        }

        .quick-fix h3 {
            color: #1976D2;
            margin-bottom: 8px;
        }

        .quick-fix p {
            color: #1565c0;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="card header">
            <h1>ğŸ” GitHub éƒ¨ç½²æª¢æŸ¥å™¨</h1>
            <p>æª¢æ¸¬ä¸¦ä¿®å¾© 404 éŒ¯èª¤</p>
        </div>

        <!-- æª¢æŸ¥è¼¸å…¥ -->
        <div class="card">
            <h3 style="margin-bottom: 16px; color: #2c3e50;">ğŸ“ è¼¸å…¥æ‚¨çš„ GitHub è³‡è¨Š</h3>
            
            <label style="display: block; margin-bottom: 8px; font-weight: bold;">GitHub ç”¨æˆ¶åï¼š</label>
            <input type="text" id="githubUsername" class="url-input" placeholder="ä¾‹å¦‚ï¼šjomywu0203" value="jomywu0203">
            
            <label style="display: block; margin-bottom: 8px; font-weight: bold;">Repository åç¨±ï¼š</label>
            <input type="text" id="repoName" class="url-input" placeholder="ä¾‹å¦‚ï¼šmphasis-checkin" value="mphasis-checkin">
            
            <button class="button button-primary" onclick="checkDeployment()">
                ğŸ” æª¢æŸ¥éƒ¨ç½²ç‹€æ…‹
            </button>
        </div>

        <!-- æª¢æŸ¥é€²åº¦ -->
        <div class="card hidden" id="progressCard">
            <h3 style="margin-bottom: 16px; color: #2c3e50;">â³ æª¢æŸ¥é€²åº¦</h3>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div id="progressText">æ­£åœ¨æª¢æŸ¥...</div>
        </div>

        <!-- æª¢æŸ¥çµæœ -->
        <div class="card hidden" id="resultCard">
            <h3 style="margin-bottom: 16px; color: #2c3e50;">ğŸ“‹ æª¢æŸ¥çµæœ</h3>
            <div id="checkResults"></div>
        </div>

        <!-- ä¿®å¾©å»ºè­° -->
        <div class="card hidden" id="fixCard">
            <h3 style="margin-bottom: 16px; color: #2c3e50;">ğŸ› ï¸ ä¿®å¾©å»ºè­°</h3>
            <div id="fixSuggestions"></div>
        </div>

        <!-- å¿«é€Ÿä¿®å¾© -->
        <div class="card">
            <h3 style="margin-bottom: 16px; color: #2c3e50;">âš¡ å¸¸è¦‹ 404 å•é¡Œå¿«é€Ÿä¿®å¾©</h3>
            
            <div class="quick-fix">
                <h3>ğŸ”§ å•é¡Œä¸€ï¼šæª”æ¡ˆæœªä¸Šå‚³</h3>
                <p>ç¢ºèªæ‚¨å·²å°‡ä»¥ä¸‹æª”æ¡ˆä¸Šå‚³åˆ° GitHub repositoryï¼š</p>
                <div class="code-box">
                    mobile_checkin_simplified.html<br>
                    simplified_configuration_profile.mobileconfig<br>
                    alternative_installer.html
                </div>
            </div>

            <div class="quick-fix">
                <h3>ğŸ”§ å•é¡ŒäºŒï¼šGitHub Pages æœªå•Ÿç”¨</h3>
                <p>å‰å¾€ Repository â†’ Settings â†’ Pages â†’ Source â†’ Deploy from a branch</p>
            </div>

            <div class="quick-fix">
                <h3>ğŸ”§ å•é¡Œä¸‰ï¼šæª”æ¡ˆåç¨±ä¸åŒ¹é…</h3>
                <p>ç¢ºèªé…ç½®æ–‡ä»¶ä¸­çš„ URL èˆ‡å¯¦éš›æª”æ¡ˆåç¨±å®Œå…¨ä¸€è‡´</p>
            </div>

            <button class="button button-secondary" onclick="generateCorrectConfig()">
                ğŸ“„ ç”Ÿæˆæ­£ç¢ºçš„é…ç½®æ–‡ä»¶
            </button>
            
            <button class="button button-warning" onclick="showManualFix()">
                ğŸ”§ æ‰‹å‹•ä¿®å¾©æ­¥é©Ÿ
            </button>
        </div>

        <!-- æ‰‹å‹•ä¿®å¾©æ­¥é©Ÿ -->
        <div class="card hidden" id="manualFixCard">
            <h3 style="margin-bottom: 16px; color: #2c3e50;">ğŸ“‹ æ‰‹å‹•ä¿®å¾©æ­¥é©Ÿ</h3>
            
            <div class="step">
                <div class="step-number">1</div>
                <div class="step-content">
                    <div class="step-title">æª¢æŸ¥æª”æ¡ˆæ˜¯å¦å­˜åœ¨</div>
                    <div class="step-description">ç¢ºèª mobile_checkin_simplified.html å·²ä¸Šå‚³åˆ°æ‚¨çš„ GitHub repository</div>
                </div>
            </div>

            <div class="step">
                <div class="step-number">2</div>
                <div class="step-content">
                    <div class="step-title">å•Ÿç”¨ GitHub Pages</div>
                    <div class="step-description">Repository â†’ Settings â†’ Pages â†’ Source: Deploy from a branch â†’ Branch: main</div>
                </div>
            </div>

            <div class="step">
                <div class="step-number">3</div>
                <div class="step-content">
                    <div class="step-title">ä¿®æ­£é…ç½®æ–‡ä»¶ä¸­çš„ URL</div>
                    <div class="step-description">ç¢ºèª .mobileconfig æª”æ¡ˆä¸­çš„ URL æŒ‡å‘æ­£ç¢ºçš„ GitHub Pages åœ°å€</div>
                </div>
            </div>

            <div class="step">
                <div class="step-number">4</div>
                <div class="step-content">
                    <div class="step-title">ç­‰å¾…éƒ¨ç½²å®Œæˆ</div>
                    <div class="step-description">GitHub Pages éƒ¨ç½²å¯èƒ½éœ€è¦ 5-10 åˆ†é˜ï¼Œè«‹è€å¿ƒç­‰å¾…</div>
                </div>
            </div>

            <div class="step">
                <div class="step-number">5</div>
                <div class="step-content">
                    <div class="step-title">é‡æ–°å®‰è£é…ç½®æ–‡ä»¶</div>
                    <div class="step-description">åˆªé™¤èˆŠçš„é…ç½®æ–‡ä»¶ï¼Œé‡æ–°ä¸‹è¼‰ä¸¦å®‰è£ä¿®æ­£å¾Œçš„ç‰ˆæœ¬</div>
                </div>
            </div>
        </div>

        <!-- ç”Ÿæˆçš„é…ç½®æ–‡ä»¶ -->
        <div class="card hidden" id="generatedConfigCard">
            <h3 style="margin-bottom: 16px; color: #2c3e50;">ğŸ“„ ä¿®æ­£å¾Œçš„é…ç½®æ–‡ä»¶</h3>
            <div id="generatedConfigContent"></div>
            <button class="button button-primary" onclick="downloadCorrectConfig()">
                ğŸ“¥ ä¸‹è¼‰ä¿®æ­£å¾Œçš„é…ç½®æ–‡ä»¶
            </button>
        </div>
    </div>

    <script>
        let generatedConfig = '';
        
        // æª¢æŸ¥éƒ¨ç½²ç‹€æ…‹
        async function checkDeployment() {
            const username = document.getElementById('githubUsername').value.trim();
            const repo = document.getElementById('repoName').value.trim();
            
            if (!username || !repo) {
                alert('è«‹è¼¸å…¥ GitHub ç”¨æˆ¶åå’Œ Repository åç¨±');
                return;
            }
            
            // é¡¯ç¤ºé€²åº¦å¡ç‰‡
            document.getElementById('progressCard').classList.remove('hidden');
            document.getElementById('resultCard').classList.add('hidden');
            document.getElementById('fixCard').classList.add('hidden');
            
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            
            const filesToCheck = [
                'mobile_checkin_simplified.html',
                'simplified_configuration_profile.mobileconfig',
                'alternative_installer.html'
            ];
            
            const results = [];
            let progress = 0;
            
            for (let i = 0; i < filesToCheck.length; i++) {
                const file = filesToCheck[i];
                progress = ((i + 1) / filesToCheck.length) * 100;
                progressFill.style.width = progress + '%';
                progressText.textContent = `æª¢æŸ¥æª”æ¡ˆï¼š${file}`;
                
                const exists = await checkFileExists(username, repo, file);
                results.push({ file, exists });
                
                await new Promise(resolve => setTimeout(resolve, 500)); // å»¶é²ä»¥é¡¯ç¤ºé€²åº¦
            }
            
            // æª¢æŸ¥ GitHub Pages ç‹€æ…‹
            progressText.textContent = 'æª¢æŸ¥ GitHub Pages ç‹€æ…‹...';
            const pagesEnabled = await checkGitHubPages(username, repo);
            
            // é¡¯ç¤ºçµæœ
            displayResults(results, pagesEnabled, username, repo);
        }
        
        // æª¢æŸ¥æª”æ¡ˆæ˜¯å¦å­˜åœ¨
        async function checkFileExists(username, repo, filename) {
            try {
                const url = `https://api.github.com/repos/${username}/${repo}/contents/${filename}`;
                const response = await fetch(url);
                return response.status === 200;
            } catch (error) {
                console.error('æª¢æŸ¥æª”æ¡ˆå¤±æ•—:', error);
                return false;
            }
        }
        
        // æª¢æŸ¥ GitHub Pages ç‹€æ…‹
        async function checkGitHubPages(username, repo) {
            try {
                const url = `https://${username}.github.io/${repo}/mobile_checkin_simplified.html`;
                const response = await fetch(url, { mode: 'no-cors' });
                return true; // å¦‚æœæ²’æœ‰éŒ¯èª¤ï¼Œå‡è¨­é é¢å­˜åœ¨
            } catch (error) {
                return false;
            }
        }
        
        // é¡¯ç¤ºæª¢æŸ¥çµæœ
        function displayResults(results, pagesEnabled, username, repo) {
            document.getElementById('progressCard').classList.add('hidden');
            document.getElementById('resultCard').classList.remove('hidden');
            
            const resultsContainer = document.getElementById('checkResults');
            let html = '';
            
            // æª¢æŸ¥æª”æ¡ˆçµæœ
            results.forEach(result => {
                const statusClass = result.exists ? 'file-exists' : 'file-missing';
                const statusText = result.exists ? 'âœ… å­˜åœ¨' : 'âŒ ç¼ºå¤±';
                
                html += `
                    <div class="file-check">
                        <span class="file-name">${result.file}</span>
                        <span class="file-status ${statusClass}">${statusText}</span>
                    </div>
                `;
            });
            
            // GitHub Pages ç‹€æ…‹
            const pagesStatusClass = pagesEnabled ? 'status-success' : 'status-error';
            const pagesStatusText = pagesEnabled ? 'âœ… GitHub Pages æ­£å¸¸' : 'âŒ GitHub Pages å¯èƒ½æœªå•Ÿç”¨æˆ–éƒ¨ç½²ä¸­';
            
            html += `
                <div class="status-box ${pagesStatusClass}">
                    <strong>${pagesStatusText}</strong>
                </div>
            `;
            
            resultsContainer.innerHTML = html;
            
            // ç”Ÿæˆä¿®å¾©å»ºè­°
            generateFixSuggestions(results, pagesEnabled, username, repo);
        }
        
        // ç”Ÿæˆä¿®å¾©å»ºè­°
        function generateFixSuggestions(results, pagesEnabled, username, repo) {
            document.getElementById('fixCard').classList.remove('hidden');
            
            const fixContainer = document.getElementById('fixSuggestions');
            let suggestions = '';
            
            const missingFiles = results.filter(r => !r.exists);
            
            if (missingFiles.length > 0) {
                suggestions += `
                    <div class="status-box status-error">
                        <strong>âŒ ç¼ºå¤±æª”æ¡ˆï¼š</strong><br>
                        ${missingFiles.map(f => f.file).join('<br>')}
                        <br><br>
                        è«‹ä¸Šå‚³é€™äº›æª”æ¡ˆåˆ°æ‚¨çš„ GitHub repositoryã€‚
                    </div>
                `;
            }
            
            if (!pagesEnabled) {
                suggestions += `
                    <div class="status-box status-warning">
                        <strong>âš ï¸ GitHub Pages å•é¡Œï¼š</strong><br>
                        è«‹å‰å¾€ Repository â†’ Settings â†’ Pages â†’ å•Ÿç”¨ GitHub Pages
                    </div>
                `;
            }
            
            // æä¾›æ­£ç¢ºçš„ URL
            suggestions += `
                <div class="status-box status-success">
                    <strong>âœ… æ­£ç¢ºçš„æª”æ¡ˆ URLï¼š</strong><br>
                    <div class="code-box">
                        https://${username}.github.io/${repo}/mobile_checkin_simplified.html
                    </div>
                    è«‹ç¢ºèªé…ç½®æ–‡ä»¶ä¸­çš„ URL èˆ‡æ­¤ä¸€è‡´ã€‚
                </div>
            `;
            
            fixContainer.innerHTML = suggestions;
        }
        
        // ç”Ÿæˆæ­£ç¢ºçš„é…ç½®æ–‡ä»¶
        function generateCorrectConfig() {
            const username = document.getElementById('githubUsername').value.trim();
            const repo = document.getElementById('repoName').value.trim();
            
            if (!username || !repo) {
                alert('è«‹å…ˆè¼¸å…¥ GitHub ç”¨æˆ¶åå’Œ Repository åç¨±');
                return;
            }
            
            const correctUrl = `https://${username}.github.io/${repo}/mobile_checkin_simplified.html`;
            
            generatedConfig = `<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <!-- é…ç½®æ–‡ä»¶ä¸»è¦è³‡è¨Š -->
    <key>PayloadDisplayName</key>
    <string>Mphasis ç°¡åŒ–æ‰“å¡ç³»çµ±</string>
    <key>PayloadDescription</key>
    <string>Mphasis CheckIN ç°¡åŒ–ç‰ˆæ‰“å¡ç³»çµ± - ç„¡éœ€å¸³è™Ÿå¯†ç¢¼ï¼Œå¯è‡ªè¨‚è¨­å®š</string>
    <key>PayloadIdentifier</key>
    <string>com.mphasis.checkin.simplified</string>
    <key>PayloadOrganization</key>
    <string>Mphasis Limited</string>
    <key>PayloadRemovalDisallowed</key>
    <false/>
    <key>PayloadType</key>
    <string>Configuration</string>
    <key>PayloadUUID</key>
    <string>${generateUUID()}</string>
    <key>PayloadVersion</key>
    <integer>1</integer>
    <key>PayloadScope</key>
    <string>User</string>
    
    <!-- é…ç½®å…§å®¹ -->
    <key>PayloadContent</key>
    <array>
        <!-- Web Clip é…ç½® -->
        <dict>
            <key>PayloadType</key>
            <string>com.apple.webClip.managed</string>
            <key>PayloadVersion</key>
            <integer>1</integer>
            <key>PayloadIdentifier</key>
            <string>com.mphasis.checkin.webclip.simplified</string>
            <key>PayloadUUID</key>
            <string>${generateUUID()}</string>
            <key>PayloadDisplayName</key>
            <string>Mphasis ç°¡åŒ–æ‰“å¡</string>
            <key>PayloadDescription</key>
            <string>Mphasis CheckIN ç°¡åŒ–ç‰ˆæ‰“å¡ç³»çµ± Web Clip</string>
            
            <!-- Web Clip è¨­å®š -->
            <key>Label</key>
            <string>Mphasisç°¡åŒ–æ‰“å¡</string>
            <key>URL</key>
            <string>${correctUrl}</string>
            <key>IsRemovable</key>
            <true/>
            <key>FullScreen</key>
            <true/>
            <key>Precomposed</key>
            <false/>
        </dict>
    </array>
</dict>
</plist>`;
            
            document.getElementById('generatedConfigContent').innerHTML = `
                <div class="status-box status-success">
                    âœ… é…ç½®æ–‡ä»¶å·²ç”Ÿæˆï¼Œä½¿ç”¨æ­£ç¢ºçš„ GitHub Pages URL
                </div>
                <div class="code-box" style="max-height: 200px; overflow-y: auto;">
                    ${generatedConfig.substring(0, 500)}...
                </div>
                <p><strong>æ­£ç¢ºçš„æ‡‰ç”¨ URLï¼š</strong></p>
                <div class="code-box">${correctUrl}</div>
            `;
            
            document.getElementById('generatedConfigCard').classList.remove('hidden');
        }
        
        // ä¸‹è¼‰æ­£ç¢ºçš„é…ç½®æ–‡ä»¶
        function downloadCorrectConfig() {
            if (!generatedConfig) {
                alert('è«‹å…ˆç”Ÿæˆé…ç½®æ–‡ä»¶');
                return;
            }
            
            const blob = new Blob([generatedConfig], { type: 'application/x-apple-aspen-config' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'corrected_configuration_profile.mobileconfig';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert('âœ… ä¿®æ­£å¾Œçš„é…ç½®æ–‡ä»¶å·²ä¸‹è¼‰ï¼\\n\\nè«‹ï¼š\\n1. åˆªé™¤èˆŠçš„é…ç½®æ–‡ä»¶\\n2. å®‰è£æ–°çš„é…ç½®æ–‡ä»¶\\n3. ç¢ºèª HTML æª”æ¡ˆå·²ä¸Šå‚³åˆ° GitHub');
        }
        
        // é¡¯ç¤ºæ‰‹å‹•ä¿®å¾©æ­¥é©Ÿ
        function showManualFix() {
            document.getElementById('manualFixCard').classList.toggle('hidden');
        }
        
        // ç”Ÿæˆ UUID
        function generateUUID() {
            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                const r = Math.random() * 16 | 0;
                const v = c == 'x' ? r : (r & 0x3 | 0x8);
                return v.toString(16);
            });
        }
        
        // é é¢è¼‰å…¥æ™‚è‡ªå‹•è¨­å®šç”¨æˆ¶è³‡è¨Šï¼ˆå¦‚æœæœ‰çš„è©±ï¼‰
        document.addEventListener('DOMContentLoaded', function() {
            // å¯ä»¥å¾ URL åƒæ•¸æˆ–å…¶ä»–æ–¹å¼ç²å–ç”¨æˆ¶è³‡è¨Š
            const urlParams = new URLSearchParams(window.location.search);
            const username = urlParams.get('username');
            const repo = urlParams.get('repo');
            
            if (username) document.getElementById('githubUsername').value = username;
            if (repo) document.getElementById('repoName').value = repo;
        });
    </script>
</body>
</html>

