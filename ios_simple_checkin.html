<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ğŸ“± iOS ç°¡æ˜“æ‰“å¡</title>
    
    <!-- iOS PWA å„ªåŒ– -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="iOSç°¡æ˜“æ‰“å¡">
    <meta name="theme-color" content="#007AFF">
    
    <style>
        /* iOS å®‰å…¨å€åŸŸæ”¯æ´ */
        :root {
            --safe-area-inset-top: env(safe-area-inset-top);
            --safe-area-inset-bottom: env(safe-area-inset-bottom);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            /* ç§»é™¤ iOS Safari çš„é»æ“Šé«˜äº® */
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
            /* é¿å…é¸å–æ–‡å­— */
            -webkit-user-select: none;
            -webkit-touch-callout: none;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', 'SF Pro Icons', 'Helvetica Neue', Helvetica, Arial, sans-serif;
            background: #F2F2F7;
            color: #000;
            min-height: 100vh;
            padding-top: var(--safe-area-inset-top);
            padding-bottom: var(--safe-area-inset-bottom);
        }

        .container {
            max-width: 375px;
            margin: 0 auto;
            padding: 20px 16px;
        }

        /* iOS ç‹€æ…‹åˆ— */
        .header {
            background: #007AFF;
            color: white;
            text-align: center;
            padding: 20px;
            border-radius: 16px;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0, 122, 255, 0.3);
        }

        .header h1 {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .header p {
            font-size: 16px;
            opacity: 0.9;
        }

        /* æ™‚é–“å¡ç‰‡ */
        .time-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            text-align: center;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .current-time {
            font-size: 42px;
            font-weight: 200;
            color: #000;
            margin-bottom: 8px;
            font-feature-settings: "tnum";
        }

        .current-date {
            font-size: 16px;
            color: #8E8E93;
        }

        /* æŒ‰éˆ•æ¨£å¼ - ç°¡åŒ–ç‰ˆ */
        .btn {
            display: block;
            width: 100%;
            padding: 16px 20px;
            font-size: 18px;
            font-weight: 600;
            border: none;
            border-radius: 12px;
            margin: 12px 0;
            text-decoration: none;
            text-align: center;
            cursor: pointer;
            /* iOS å°ˆç”¨è§¸æ§å„ªåŒ– */
            touch-action: manipulation;
            -webkit-appearance: none;
            /* ç°¡å–®çš„éæ¸¡æ•ˆæœ */
            transition: background-color 0.2s ease, transform 0.1s ease;
        }

        .btn-primary {
            background: #007AFF;
            color: white;
        }

        .btn-secondary {
            background: #34C759;
            color: white;
        }

        .btn-tertiary {
            background: #FF9500;
            color: white;
        }

        .btn-danger {
            background: #FF3B30;
            color: white;
        }

        /* iOS è§¸æ§åé¥‹ */
        .btn:active {
            transform: scale(0.98);
            opacity: 0.8;
        }

        .btn-primary:active {
            background: #0056CC;
        }

        .btn-secondary:active {
            background: #28A745;
        }

        .btn-tertiary:active {
            background: #CC7A00;
        }

        /* å¡ç‰‡å®¹å™¨ */
        .card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .card h3 {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 16px;
            color: #000;
        }

        /* è¼¸å…¥æ¡† */
        .input-field {
            width: 100%;
            padding: 12px 16px;
            font-size: 16px;
            border: 1px solid #E5E5EA;
            border-radius: 10px;
            background: #F9F9F9;
            margin: 8px 0;
            /* iOS å°ˆç”¨ */
            -webkit-appearance: none;
        }

        .input-field:focus {
            outline: none;
            border-color: #007AFF;
            background: white;
        }

        /* ç‹€æ…‹è¨Šæ¯ */
        .message {
            padding: 16px;
            border-radius: 12px;
            margin: 16px 0;
            font-size: 16px;
            text-align: center;
        }

        .message-success {
            background: #E8F5E8;
            color: #1B5E20;
            border: 2px solid #34C759;
        }

        .message-error {
            background: #FFEBEE;
            color: #C62828;
            border: 2px solid #FF3B30;
        }

        .message-info {
            background: #E3F2FD;
            color: #0D47A1;
            border: 2px solid #007AFF;
        }

        /* èªªæ˜æ–‡å­— */
        .help-text {
            font-size: 14px;
            color: #8E8E93;
            line-height: 1.4;
            margin: 8px 0;
        }

        /* éš±è—é¡ */
        .hidden {
            display: none !important;
        }

        /* è¼‰å…¥å‹•ç•« */
        .loading {
            display: inline-block;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- æ¨™é¡Œ -->
        <div class="header">
            <h1>ğŸ“± iOS ç°¡æ˜“æ‰“å¡</h1>
            <p>å°ˆç‚º iPhone Safari è¨­è¨ˆ</p>
        </div>

        <!-- æ™‚é–“é¡¯ç¤º -->
        <div class="time-card">
            <div class="current-time" id="timeDisplay">--:--</div>
            <div class="current-date" id="dateDisplay">è¼‰å…¥ä¸­...</div>
        </div>

        <!-- ä¸»è¦åŠŸèƒ½ -->
        <div class="card">
            <h3>âš¡ å¿«é€Ÿæ‰“å¡</h3>
            
            <!-- ç°¡åŒ–çš„æŒ‰éˆ•ï¼Œä½¿ç”¨ onclick è€Œä¸æ˜¯ addEventListener -->
            <button class="btn btn-primary" onclick="openCheckinSite()">
                ğŸ¯ ç«‹å³æ‰“å¡
            </button>
            
            <button class="btn btn-secondary" onclick="copyCheckinUrl()">
                ğŸ“‹ è¤‡è£½æ‰“å¡ç¶²å€
            </button>
            
            <button class="btn btn-tertiary" onclick="showInstructions()">
                ğŸ“– æ“ä½œèªªæ˜
            </button>
        </div>

        <!-- è¨­å®š -->
        <div class="card">
            <h3>âš™ï¸ åŸºæœ¬è¨­å®š</h3>
            
            <div class="help-text">æ‰“å¡ç¶²å€ï¼š</div>
            <input type="url" class="input-field" id="checkinUrl" 
                   value="https://enterprise-apps.mphasis.com/ess/v1/#/home">
            
            <div class="help-text">å…¬å¸åç¨±ï¼š</div>
            <input type="text" class="input-field" id="companyName" 
                   value="Mphasis">
            
            <button class="btn btn-primary" onclick="saveSettings()">
                ğŸ’¾ å„²å­˜è¨­å®š
            </button>
        </div>

        <!-- è¨Šæ¯é¡¯ç¤ºå€åŸŸ -->
        <div id="messageArea"></div>

        <!-- æ“ä½œèªªæ˜ -->
        <div class="card" id="instructionsCard" style="display: none;">
            <h3>ğŸ“– ä½¿ç”¨èªªæ˜</h3>
            <div style="font-size: 16px; line-height: 1.6; color: #333;">
                <strong>ğŸ¯ ç«‹å³æ‰“å¡ï¼š</strong><br>
                é»æ“Šå¾Œæœƒé–‹å•Ÿæ‰“å¡ç¶²ç«™ï¼Œè«‹åœ¨æ–°é é¢ä¸­å®Œæˆç™»å…¥å’Œæ‰“å¡ã€‚<br><br>
                
                <strong>ğŸ“‹ è¤‡è£½ç¶²å€ï¼š</strong><br>
                å°‡æ‰“å¡ç¶²å€è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼Œå¯ä»¥åœ¨ Safari ä¸­è²¼ä¸Šä½¿ç”¨ã€‚<br><br>
                
                <strong>ğŸ’¡ ä½¿ç”¨æŠ€å·§ï¼š</strong><br>
                â€¢ å»ºè­°å°‡æ­¤é é¢åŠ å…¥ä¸»ç•«é¢<br>
                â€¢ åœ¨ Safari ä¸­é»æ“Šåˆ†äº« â†’ åŠ å…¥ä¸»ç•«é¢<br>
                â€¢ æ¯å¤©ä½¿ç”¨ä¸»ç•«é¢åœ–ç¤ºå¿«é€Ÿæ‰“å¡<br>
            </div>
            
            <button class="btn btn-secondary" onclick="hideInstructions()">
                âœ… æˆ‘çŸ¥é“äº†
            </button>
        </div>

        <!-- æ¸¬è©¦å€åŸŸ -->
        <div class="card">
            <h3>ğŸ§ª åŠŸèƒ½æ¸¬è©¦</h3>
            <div class="help-text">æ¸¬è©¦æŒ‰éˆ•æ˜¯å¦æ­£å¸¸å·¥ä½œ</div>
            
            <button class="btn btn-secondary" onclick="testFunction()">
                ğŸ”˜ æ¸¬è©¦æŒ‰éˆ•é»æ“Š
            </button>
            
            <button class="btn btn-tertiary" onclick="testAlert()">
                ğŸ”” æ¸¬è©¦å½ˆçª—é¡¯ç¤º
            </button>
        </div>
    </div>

    <script>
        // å…¨åŸŸè®Šæ•¸
        var settings = {
            checkinUrl: 'https://enterprise-apps.mphasis.com/ess/v1/#/home',
            companyName: 'Mphasis'
        };

        // åˆå§‹åŒ– - ä½¿ç”¨æœ€ç°¡å–®çš„æ–¹å¼
        function initApp() {
            console.log('ğŸ“± iOS ç°¡æ˜“æ‰“å¡æ‡‰ç”¨å•Ÿå‹•');
            loadSettings();
            updateTime();
            setInterval(updateTime, 1000);
            showMessage('âœ… æ‡‰ç”¨å·²æˆåŠŸè¼‰å…¥ï¼', 'success');
        }

        // æ›´æ–°æ™‚é–“é¡¯ç¤º
        function updateTime() {
            try {
                var now = new Date();
                var hours = now.getHours().toString().padStart(2, '0');
                var minutes = now.getMinutes().toString().padStart(2, '0');
                var timeString = hours + ':' + minutes;
                
                var options = { 
                    year: 'numeric',
                    month: 'long', 
                    day: 'numeric',
                    weekday: 'long'
                };
                var dateString = now.toLocaleDateString('zh-TW', options);
                
                document.getElementById('timeDisplay').textContent = timeString;
                document.getElementById('dateDisplay').textContent = dateString;
            } catch (error) {
                console.error('æ™‚é–“æ›´æ–°å¤±æ•—:', error);
                document.getElementById('timeDisplay').textContent = 'æ™‚é–“éŒ¯èª¤';
                document.getElementById('dateDisplay').textContent = 'è«‹é‡æ–°è¼‰å…¥';
            }
        }

        // é–‹å•Ÿæ‰“å¡ç¶²ç«™
        function openCheckinSite() {
            showMessage('ğŸš€ æ­£åœ¨é–‹å•Ÿæ‰“å¡ç¶²ç«™...', 'info');
            
            try {
                var popup = window.open(settings.checkinUrl, '_blank');
                
                if (popup) {
                    showMessage('âœ… æ‰“å¡ç¶²ç«™å·²é–‹å•Ÿï¼è«‹åœ¨æ–°é é¢ä¸­å®Œæˆæ‰“å¡ã€‚', 'success');
                } else {
                    showMessage('âŒ ç„¡æ³•é–‹å•Ÿç¶²ç«™ï¼Œè«‹å…è¨±å½ˆçª—æˆ–ç›´æ¥é»æ“Šä¸‹æ–¹è¤‡è£½çš„ç¶²å€ã€‚', 'error');
                    copyCheckinUrl();
                }
            } catch (error) {
                console.error('é–‹å•Ÿç¶²ç«™å¤±æ•—:', error);
                showMessage('âŒ é–‹å•Ÿå¤±æ•—ï¼Œå·²ç‚ºæ‚¨è¤‡è£½ç¶²å€ï¼Œè«‹æ‰‹å‹•åœ¨ Safari ä¸­é–‹å•Ÿã€‚', 'error');
                copyCheckinUrl();
            }
        }

        // è¤‡è£½æ‰“å¡ç¶²å€
        function copyCheckinUrl() {
            try {
                // å˜—è©¦ä½¿ç”¨ç¾ä»£ API
                if (navigator.clipboard && window.isSecureContext) {
                    navigator.clipboard.writeText(settings.checkinUrl).then(function() {
                        showMessage('âœ… æ‰“å¡ç¶²å€å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼', 'success');
                    }).catch(function(error) {
                        fallbackCopy();
                    });
                } else {
                    fallbackCopy();
                }
            } catch (error) {
                fallbackCopy();
            }
        }

        // å‚™ç”¨è¤‡è£½æ–¹æ³•
        function fallbackCopy() {
            try {
                var textArea = document.createElement('textarea');
                textArea.value = settings.checkinUrl;
                textArea.style.position = 'fixed';
                textArea.style.left = '-999999px';
                textArea.style.top = '-999999px';
                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();
                
                var successful = document.execCommand('copy');
                document.body.removeChild(textArea);
                
                if (successful) {
                    showMessage('âœ… ç¶²å€å·²è¤‡è£½ï¼è«‹åœ¨ Safari ä¸­è²¼ä¸Šé–‹å•Ÿã€‚', 'success');
                } else {
                    showMessage('ğŸ“ è«‹æ‰‹å‹•è¤‡è£½æ­¤ç¶²å€ï¼š' + settings.checkinUrl, 'info');
                }
            } catch (error) {
                showMessage('ğŸ“ è«‹æ‰‹å‹•è¤‡è£½æ­¤ç¶²å€ï¼š' + settings.checkinUrl, 'info');
            }
        }

        // é¡¯ç¤ºèªªæ˜
        function showInstructions() {
            document.getElementById('instructionsCard').style.display = 'block';
            document.getElementById('instructionsCard').scrollIntoView({ behavior: 'smooth' });
        }

        // éš±è—èªªæ˜
        function hideInstructions() {
            document.getElementById('instructionsCard').style.display = 'none';
        }

        // å„²å­˜è¨­å®š
        function saveSettings() {
            try {
                var checkinUrl = document.getElementById('checkinUrl').value.trim();
                var companyName = document.getElementById('companyName').value.trim();
                
                if (!checkinUrl || !companyName) {
                    showMessage('âŒ è«‹å¡«å¯«å®Œæ•´çš„è¨­å®šè³‡è¨Š', 'error');
                    return;
                }
                
                // ç°¡å–®çš„ç¶²å€é©—è­‰
                if (!checkinUrl.startsWith('http://') && !checkinUrl.startsWith('https://')) {
                    showMessage('âŒ è«‹è¼¸å…¥å®Œæ•´çš„ç¶²å€ï¼ˆä»¥ http:// æˆ– https:// é–‹é ­ï¼‰', 'error');
                    return;
                }
                
                settings.checkinUrl = checkinUrl;
                settings.companyName = companyName;
                
                // å„²å­˜åˆ° localStorage
                localStorage.setItem('ios_simple_settings', JSON.stringify(settings));
                
                showMessage('âœ… è¨­å®šå·²å„²å­˜ï¼', 'success');
            } catch (error) {
                console.error('å„²å­˜è¨­å®šå¤±æ•—:', error);
                showMessage('âŒ å„²å­˜å¤±æ•—ï¼Œè«‹é‡è©¦', 'error');
            }
        }

        // è¼‰å…¥è¨­å®š
        function loadSettings() {
            try {
                var saved = localStorage.getItem('ios_simple_settings');
                if (saved) {
                    var parsedSettings = JSON.parse(saved);
                    settings.checkinUrl = parsedSettings.checkinUrl || settings.checkinUrl;
                    settings.companyName = parsedSettings.companyName || settings.companyName;
                    
                    // æ›´æ–° UI
                    document.getElementById('checkinUrl').value = settings.checkinUrl;
                    document.getElementById('companyName').value = settings.companyName;
                }
            } catch (error) {
                console.error('è¼‰å…¥è¨­å®šå¤±æ•—:', error);
            }
        }

        // æ¸¬è©¦åŠŸèƒ½
        function testFunction() {
            showMessage('ğŸ‰ æŒ‰éˆ•é»æ“ŠåŠŸèƒ½æ­£å¸¸ï¼', 'success');
            console.log('æ¸¬è©¦åŠŸèƒ½è¢«å‘¼å«');
        }

        // æ¸¬è©¦å½ˆçª—
        function testAlert() {
            alert('ğŸ”” å½ˆçª—åŠŸèƒ½æ­£å¸¸ï¼\n\niOS Safari æ”¯æ´æ­¤åŠŸèƒ½ã€‚');
        }

        // é¡¯ç¤ºè¨Šæ¯
        function showMessage(message, type) {
            type = type || 'info';
            var messageArea = document.getElementById('messageArea');
            
            var messageClass = 'message-' + type;
            messageArea.innerHTML = '<div class="message ' + messageClass + '">' + message + '</div>';
            
            // 5ç§’å¾Œæ¸…é™¤è¨Šæ¯
            setTimeout(function() {
                messageArea.innerHTML = '';
            }, 5000);
        }

        // é é¢è¼‰å…¥å®Œæˆå¾Œåˆå§‹åŒ–
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initApp);
        } else {
            initApp();
        }

        console.log('ğŸ“± iOS ç°¡æ˜“æ‰“å¡è…³æœ¬å·²è¼‰å…¥');
    </script>
</body>
</html>
